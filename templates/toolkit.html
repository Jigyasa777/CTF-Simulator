{% extends "layout.html" %}
{% block title %}Toolkit - Cybersecurity Dashboard{% endblock %}

{% block content %}
<style>
  .toolkit-section {
    background: #fff8dc;
    padding: 60px 30px;
    color: #001f3f;
    min-height: 100vh;
  }
  .toolkit-banner {
    background-color: #ffcc00;
    color: #000;
    font-size: 1.6rem;
    text-align: center;
    padding: 14px;
    margin-bottom: 40px;
    border-radius: 10px;
    font-weight: 900;
    animation: bounce 1s infinite;
  }
  @keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-6px); }
  }
  .terminal-window, .code-block {
    background-color: #f4f4f4;
    color: #000;
    padding: 10px;
    margin-top: 10px;
    border-radius: 5px;
    font-family: monospace;
  }
  .instructions {
    background: #fffbcc;
    padding: 10px 15px;
    border-left: 5px solid #ffcc00;
    margin-bottom: 10px;
    border-radius: 6px;
    font-size: 0.95rem;
  }
</style>

<div class="toolkit-section">
  <div class="toolkit-banner">ðŸ”¥ <strong>Learn by Doing</strong> ðŸ”¥</div>
  <h1 class="toolkit-header">Embedded Security Toolkit</h1>
  <p style="text-align:center;">These hands-on exercises are modeled after real-world scenarios faced in the MITRE eCTF. Follow the instructions to simulate secure design and attack techniques.</p>

  <div class="toolkit-grid">
    <!-- UART CLI Demo Card -->
    <div class="tool-card">
      <h2>UART Console Demo</h2>
      <div class="instructions">
        <strong>Instructions:</strong><br>
        1. Type a command below.<br>
        2. Valid commands include: <code>help</code>, <code>ping</code>, <code>version</code>, <code>reboot</code>.<br>
        3. This simulates UART communication with an embedded device.<br>
        <strong>MITRE eCTF Relevance:</strong> Simulates insecure UARTs often exposed in competition boards.
      </div>
      <input type="text" id="uart-input" placeholder="Enter UART command" />
      <button class="launch-btn" onclick="runUART()">Run Command</button>
      <pre id="uart-terminal" class="terminal-window"></pre>
    </div>

    <!-- Crypto Playground -->
    <div class="tool-card">
      <h2>Crypto Playground</h2>
      <div class="instructions">
        <strong>Instructions:</strong><br>
        1. Type any plaintext to simulate encryption.<br>
        2. The result will appear as reversed text (mock AES).<br>
        <strong>MITRE eCTF Relevance:</strong> Useful to explore custom cryptographic implementations.<br>
      </div>
      <input type="text" id="plaintext" placeholder="Enter plaintext" />
      <button onclick="doEncrypt()">Encrypt</button>
      <pre id="ciphertext" class="terminal-window"></pre>
    </div>

    <!-- Firmware RE Lab -->
    <div class="tool-card">
      <h2>Firmware Reverse Engineering Lab</h2>
      <div class="instructions">
        <strong>Instructions:</strong><br>
        1. Click the button below to view a snippet of firmware.<br>
        2. Observe patterns like hardcoded secrets and function calls.<br>
        <strong>MITRE eCTF Relevance:</strong> Demonstrates how attackers extract sensitive logic from binaries.
      </div>
      <button class="launch-btn" onclick="showFirmware()">Toggle Firmware Dump</button>
      <pre id="firmware-sample" class="code-block" style="display:none;">
08000000 <start>:
08000000:  LDR R0, =SecretKey
08000004:  BL  DecryptToken
...
08000020 <SecretKey>:
08000020:  .word 0x12EF56AB
      </pre>
    </div>

    <!-- JTAG Debug Lab -->
    <div class="tool-card">
      <h2>Hardware Debug (JTAG)</h2>
      <div class="instructions">
        <strong>Instructions:</strong><br>
        1. Click the button to simulate a JTAG debugging session.<br>
        2. This showcases OpenOCD-style output from memory reads.<br>
        <strong>MITRE eCTF Relevance:</strong> JTAG often exposes flash memory or keys in embedded systems.
      </div>
      <button class="launch-btn" onclick="showJTAG()">View Debug Output</button>
      <pre id="jtag-demo" class="code-block" style="display:none;">
> openocd -f interface.cfg -c "init; halt"
TARGET HALTED at 0x08001000
> mdw 0x08008000 3
08008000: 45435446 7B4B3A...
      </pre>
    </div>
  </div>
</div>

<script>
  function runUART() {
    const input = document.getElementById('uart-input').value.trim().toLowerCase();
    const output = document.getElementById('uart-terminal');
    let result = "";
    switch (input) {
      case 'help': result = "Available commands: help, ping, reboot, version"; break;
      case 'ping': result = "PONG"; break;
      case 'reboot': result = "Rebooting system...\nDone. (This is just a simulation!)"; break;
      case 'version': result = "Device Firmware v1.2.3 (Simulated)"; break;
      default: result = `Unknown command: ${input}`;
    }
    output.innerText = result;
  }

  function showFirmware() {
    let firmware = document.getElementById('firmware-sample');
    firmware.style.display = firmware.style.display === 'none' ? 'block' : 'none';
  }

  function showJTAG() {
    let jtag = document.getElementById('jtag-demo');
    jtag.style.display = jtag.style.display === 'none' ? 'block' : 'none';
  }

  function doEncrypt() {
    let text = document.getElementById('plaintext').value;
    document.getElementById('ciphertext').innerText = text ? text.split('').reverse().join('') : '';
  }
</script>
{% endblock %}
